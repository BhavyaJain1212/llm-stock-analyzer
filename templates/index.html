<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>üìà Personal Stock Analyzer</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap first so our custom styles can override layout/theme where needed -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

    <!-- App styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='history_table.css' )}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='analysis.css' )}}">

    <script defer src="{{ url_for('static', filename='app.js') }}"></script>
</head>

<body>
    <div class="app">
        <!-- Sidebar -->
        <aside class="sidebar">

            <section class="sidebar-section">
                <h3>Analysis Level</h3>
                <label class="label" for="analysisLevel">Select your experience level:</label>
                <select id="analysisLevel" class="select" title="This adjusts the complexity of the analysis">
                    <option value="beginner" selected>beginner</option>
                    <option value="intermediate">intermediate</option>
                    <option value="advanced">advanced</option>
                </select>
                <p class="hint">This adjusts the complexity of the analysis</p>
            </section>

            <section class="sidebar-section">
                <h3>Analysis Type</h3>
                <p class="label">Select analysis depth:</p>
                <div class="radio-group" role="radiogroup" aria-label="analysis type">
                    <label class="radio">
                        <input type="radio" name="analysisType" value="basic" checked>
                        <span>Basic</span>
                    </label>
                    <label class="radio">
                        <input type="radio" name="analysisType" value="detailed">
                        <span>Detailed</span>
                    </label>
                </div>
                <p class="hint">Basic: Key metrics | Detailed: Comprehensive analysis</p>
            </section>

            <!-- <section class="sidebar-section">
                <label class="checkbox">
                    <input type="checkbox" id="streamingToggle" checked>
                    <span>Enable streaming response</span>
                </label>
                <p class="hint">Show analysis as it's generated</p>
            </section> -->

            <hr class="divider" />

            <section class="sidebar-section">
                <h3>üîå API Status</h3>
                <button id="checkConnectionBtn" class="btn secondary" type="button">Check Connection</button>
                <div id="apiStatus" class="status" aria-live="polite"></div>
            </section>

            <hr class="divider" />

            <div class="warning-box">
                <strong>‚ö†Ô∏è Disclaimer:</strong> This is an educational demo. Not financial advice! Always do your own
                research.
            </div>

            <hr class="divider" />

        </aside>

        <!-- Main -->
        <main class="main">
            <!-- Header -->
            <header class="main-header-wrap">
                <h1 class="main-header">üìà Personal Stock Analyzer</h1>
                <p class="subtext">An educational demonstration of LLM-powered financial analysis</p>
            </header>

            <hr class="divider" />

            <!-- Input Row -->
            <section class="input-row">
                <div class="input-col">
                    <label class="label" for="tickerInput">üîç Enter Stock Ticker Symbol:</label>

                    <div class="position-relative" style="max-width: 1000px;">
                        <input id="tickerInput" class="input form-control pe-5" type="text" value="AAPL"
                            placeholder="e.g., AAPL, GOOGL, MSFT, RELIANCE.NS" autocomplete="off" />

                        <!-- Spinner inside input (right side) -->
                        <div id="tickerSpinner"
                            class="spinner-border spinner-border-sm text-secondary position-absolute top-50 end-0 translate-middle-y me-3 d-none"
                            role="status" aria-live="polite" aria-label="Loading">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>

                    <p class="hint">Enter a valid stock ticker. Use .NS suffix for NSE (India) stocks</p>

                </div>

                <div class="button-col">
                    <button id="analyzeBtn" class="btn primary" type="button" style="margin-bottom: 20px;">üìä Analyze
                        Stock</button>
                </div>
            </section>

            <div class="popular">
                <span class="popular-label">Popular tickers:</span>
                <code class="tag">AAPL</code>
                <code class="tag">GOOGL</code>
                <code class="tag">MSFT</code>
                <code class="tag">AMZN</code>
                <code class="tag">TSLA</code>
                <code class="tag">NVDA</code>
                <code class="tag">RELIANCE.NS</code>
                <code class="tag">TCS.NS</code>
            </div>

            <hr class="divider" />

            <!-- Status messages (success/warn/error) -->
            <section id="messageArea" class="message-area" aria-live="polite"></section>

            <!-- Results -->
            <section id="results" class="results hidden">
                <div class="result-header">
                    <div class="pill success" id="foundPill">‚úÖ Found:
                        <strong id="foundName">Apple Inc.</strong> (<span id="foundSymbol">AAPL</span>)
                    </div>
                    <!-- <div class="pill warning hidden" id="demoPill">
                        ‚ö†Ô∏è <strong>Using Demo Data</strong> - Yahoo Finance is temporarily rate-limited.
                    </div> -->
                </div>

                <!-- Key Metrics -->
                <h2 class="section-title">üìà Key Metrics</h2>

                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-label">Current Price</div>
                        <div class="metric-value" id="mPrice">$0.00</div>
                        <div class="metric-delta" id="mDelta">0.00%</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">Market Cap</div>
                        <div class="metric-value" id="mMcap">‚Äî</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">Volume</div>
                        <div class="metric-value" id="mVol">‚Äî</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">P/E Ratio</div>
                        <div class="metric-value" id="mPe">N/A</div>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-label">52-Week High</div>
                        <div class="metric-value" id="mHigh">$0.00</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">52-Week Low</div>
                        <div class="metric-value" id="mLow">$0.00</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">Dividend Yield</div>
                        <div class="metric-value" id="mDiv">N/A</div>
                    </div>

                    <div class="metric">
                        <div class="metric-label">Sector</div>
                        <div class="metric-value" id="mSector">N/A</div>
                    </div>
                </div>

                <hr class="divider" />

                <!-- Price history expander -->
                <details class="expander">
                    <summary>üìä Price History (30 Days)</summary>

                    <div class="expander-body">
                        <div class="table-wrap">
                            <table class="history-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Open</th>
                                        <th>High</th>
                                        <th>Low</th>
                                        <th>Close</th>
                                        <th>Volume</th>
                                    </tr>
                                </thead>
                                <tbody id="historyBody"></tbody>
                            </table>
                        </div>

                        <p class="hint" id="historyHint">Historical data not available</p>
                    </div>
                </details>

                <hr class="divider" />

                <!-- AI Analysis -->
                <h2 class="section-title">ü§ñ AI-Powered Analysis</h2>

                <div class="analysis-box">
                    <div class="analysis-toolbar">
                        <div class="left">
                            <span class="chip" id="chipLevel">Level: beginner</span>
                            <span class="chip" id="chipType">Type: basic</span>
                        </div>

                        <!-- <div class="right">
                            <button id="regenBtn" class="btn secondary" type="button">üß† Generate analysis</button>
                        </div> -->
                    </div>
                    <!-- AI analysis output -->
                    <div id="analysisOutput" class="analysis-output">
                        <section>
                            <h3>Company Overview</h3>
                            <p id="companyOverview"></p>
                        </section>

                        <section>
                            <h3>Key Metrics</h3>
                            <div id="metricsTable"></div>
                        </section>

                        <section>
                            <h3>Price vs 52-Week Range</h3>
                            <p id="rangeAnalysis"></p>
                        </section>

                        <section>
                            <h3>Takeaways</h3>
                            <ul id="takeawaysList"></ul>
                        </section>

                        <section>
                            <h3>Notable Concerns</h3>
                            <ul id="concernsList"></ul>
                        </section>

                        <section class="disclaimer">
                            <small id="disclaimerText"></small>
                        </section>

                    </div>
                </div>

                <!-- Raw data expander -->
                <details class="expander">
                    <summary>üìã View Raw Data</summary>
                    <div class="expander-body">
                        <pre id="rawJson" class="json-block">{}</pre>
                    </div>
                </details>
            </section>

            <hr class="divider" />

            <!-- Footer -->
            <footer class="footer">
                <p>Built with ‚ù§Ô∏è using Streamlit, yfinance, and OpenAI/Anthropic APIs</p>
                <p>Educational Demo - Not Financial Advice</p>
            </footer>
        </main>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
</body>

</html>